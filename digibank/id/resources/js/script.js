$(function(){function e(){"en"===s?"faq-results"===c?($("#lang-en").attr("href","faq-search-results.html"),$("#lang-id").attr("href","../id/faq-search-results.html")):($("#lang-en").attr("href",$("#nav-"+c).attr("href")),$("#lang-id").attr("href",$("#nav-"+c).data("lang"))):"id"===s&&("faq-results"===c?($("#lang-en").attr("href","../en/faq-search-results.html"),$("#lang-id").attr("href","faq-search-results.html")):($("#lang-en").attr("href",$("#nav-"+c).data("lang")),$("#lang-id").attr("href",$("#nav-"+c).attr("href"))))}function t(){var e=$.isDevice();e?(n.unbind(".megamenuscroll"),$("#headerMenu").removeAttr("style").removeClass("navbar-white")):$.megaMenuInit("megamenuscroll")}var n=$(window),o=$("body"),i=$.isDevice(),a=$("#footer"),s=($("#headerMenu"),$("html").attr("lang")),r="en"===s?"../resources/components/header.html":"../resources/components/header-id.html",l="en"===s?"../resources/components/footer.html":"../resources/components/footer-id.html",c=($("#lang-en"),$("#lang-id"),$("body").data("page"));(o.hasClass("body-mobile-error")||o.hasClass("sub-directory"))&&(r="../components/headerEmail.html",l="../components/footerEmail.html"),$("#headerMenu").load(r,function(){var t=$("#digiMenu");e(),$(".mega-menu .collapse").on("show.bs.collapse hide.bs.collapse",function(e){e.preventDefault()}),$("#mobMenu").on("click",function(e){e.preventDefault();var t=$($(this).data("target"));t.toggleClass("in"),t.fadeIn(),t.hasClass("in")?(t.removeClass("out"),o.addClass("mdl-body"),setTimeout(function(){t.addClass("animate-menu")},100)):(t.addClass("out").delay(200).queue(function(){$(this).removeClass("out").dequeue()}),t.removeClass("animate-menu"),o.removeClass("mdl-body"))}),i&&$(document).on("touchstart click",".mdl-body",function(e){"navbar-toggle"!=e.target.className&&"menu-link"!=e.target.className&&(t.removeClass("in"),o.removeClass("mdl-body"),t.addClass("out").delay(200).queue(function(){$(this).removeClass("out").dequeue()}))}),$.setActiveMenuLink(),$(this).hasClass("menu-white")&&($("#digiMenu .navbar-nav").addClass("nav-white"),$(".navbar-header .navbar-brand").addClass("navbar-brand-white"))}),$("#kasistoChat").load("components/chat.html",function(){$(this).removeClass("hide"),$.loadImageInit(),$.enableChat()}),a.load(l,function(){e()}),t(),n.resize(function(){t()}),$.inputOpacityInit("header .email input"),$(".btn-callus").on("click",function(){$("body").scrollTo("#callId")}),$.radioCheckFirefoxInit()}),function(e){function t(t,n){var o=e(".mob-purple"),i=e("#faqBox");e(t).hide().filter(':containIgnoreCase("'+n+'")').show(),o.find(".txt-error").hide(),o.each(function(t){var n=e(this),o=n.find(".inside-content-box:visible").length,a=n.find(".inside-content-box").length;0==o?(n.find(".count").html("(0)"),0==n.find(".txt-error").length?n.append('<label class="txt-error">No results found!</label>'):n.find(".txt-error").show()):(n.find(".count").html("("+o+")"),o==a?i.find(".clearfix").show():i.find(".clearfix").hide())})}var n=768,o=360;e.enableChat=function(){function t(e,t){switch(e){case 414:t-=382;break;case 375:t-=291;break;case 320:t-=197}window.scroll(0,t)}function n(t){e(window).unbind(".kasistoChatResize"),o()}function o(){w&&e("section,footer,header,nav").show()}function a(){w&&setTimeout(function(){e("section,footer,header,nav").hide()},400)}function s(e){i?e.style.height="30px":e.style.height="26px",e.style.height=e.scrollHeight+"px",e.scrollHeight>55?b.addClass("line-ht-threeRow"):e.scrollHeight>35&&e.scrollHeight<50?b.addClass("line-ht-twoRow"):b.removeClass("line-ht-twoRow line-ht-threeRow")}function r(){e("head meta[name=viewport]").remove(),e("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" />')}function l(){var t=e(window).height(),n=e("#mdlKasistoChat .chat-box-bottom").outerHeight()+e("#mdlKasistoChat .chat-box-title").outerHeight();g.css("height",t-n)}function c(e){if(""!=e){var t=h("chat-content");chatTpl='<div class="chat-reply-box clearfix '+t+'"><div class="chat-reply">\t<span class="arrowright"></span>\t<p class="chat-msg"></p>\t</div></div>',g.append(chatTpl),g.find(".chat-reply-box:last .chat-msg").text(e).html(),g.scrollTop(g[0].scrollHeight),p.removeAttr("style").val("")}}function d(e){if(""!=e){var t=h("chat-reply-box");chatTpl='<div class="chat-content clearfix '+t+'">\t<div class="chat-question">\t\t<span class="arrowleft"></span>\t<p class="chat-msg"></p>\t</div></div>',setTimeout(function(){g.append(chatTpl),g.find(".chat-content:last .chat-msg").html(e).text(),g.scrollTop(g[0].scrollHeight),p.removeAttr("style").val(""),v()},1e3)}}function h(t){var n="";return e("#chatBody>div").last().hasClass(t)&&(n="mTop-16"),n}function u(){var e=h("chat-reply-box");chatTpl='<div class="chat-content clearfix '+e+'">\t<div class="chat-question">\t\t<span class="arrowleft"></span>\t\t<p><strong>I\'m sorry</strong>, we are experiencing some technical difficulties. Please try again later.</p>\t</div></div>',setTimeout(function(){g.append(chatTpl),g.scrollTop(g[0].scrollHeight),p.removeAttr("style").val(""),v()},1e3)}function f(t){requestData={vpa_request:{text:{data:t},custom_context_in:{data:'{"userInfo":{"token":"NOTOKEN","userId":"PWEB","deviceId":"WEB"}}'},user_context:{user_id:"PWEB"}}},e.ajax({url:"/LolaServer/vpa",type:"POST",dataType:"json",xhrFields:{withCredentials:!0},contentType:"application/json; charset=utf-8",data:JSON.stringify(requestData),success:function(e){if("undefined"==typeof e.responseText)u();else{var t=e.responseText;e.responseText.search("href")>0&&(t=t.replace(/href=/g,'target="_blank" href=')),e.responseText.search("{{live-chat}}")>0&&(t=t.replace(/{{live-chat}}/g,"")),d(t)}},error:function(e,t,n){console.log(e),console.log(t),console.log(n),u()},headers:M})}function v(){sessionStorage.setItem("chatHistory",encodeURI(e("#chatBody").html()))}function m(){return decodeURI(sessionStorage.getItem("chatHistory"))}var p=e("#chatContent"),g=e("#chatBody"),b=e("#btnChat"),w=e.isRealDevice(),y=e("#kasistoMsg"),C=e("#mdlKasistoChat"),x=e("#btnKasisto"),k=e("#mdlKasistoChat .close"),T=e("body"),$=m();if("null"==$?setTimeout(function(){f("Hi")},1e3):g.html($),e("#kasistoMsg,#btnKasisto").on("click",function(){y.removeClass("bounceIn").fadeOut("slow"),C.modal("show")}),w){e(window).one("scroll",function(){y.addClass("fadeOut")});var I=e.isIOSDevice();if(I){var A=e(window).width(),q=e(window).height();p.on("keyup focus",function(e){t(A,q)})}}else p.on("focus",function(){e(this).removeAttr("placeholder")}).on("blur",function(){e(this).attr("placeholder","Ask your Virtual Assistant")});setTimeout(function(){x.show(),setTimeout(function(){y.addClass("bounceIn")},1500)},3e3),C.on("shown.bs.modal",function(){i?(r(),e(this).find(".modal-dialog").removeClass("slideOutDown").addClass("slideInUp"),a()):(T.addClass("bg-blur"),e(this).find(".modal-dialog").removeClass("slideOutDown slideInUp").addClass("fadeIn")),C.css("padding-right",0),l(),e(window).bind("resize.kasistoChatResize",function(){l()}),g.scrollTop(g[0].scrollHeight),w&&(e(".modal-backdrop.in").remove(),x.hide(),g.off().on("touchstart",function(){p.blur()})),e.isAndroidKarbonn()}),i?k.on("click",function(){e("#mdlKasistoChat .modal-dialog").animate({height:"0%"},200,function(){e("#mdlKasistoChat .modal-dialog").removeAttr("style"),n(),C.modal("hide")}),o(),x.show()}):(C.on("hidden.bs.modal",function(){T.removeClass("bg-blur"),o(),x.show()}),k.on("click",function(){C.modal("hide"),o()})),b.on("click",function(t){var n=e.trim(p.val());n.length>0&&(c(n),f(n)),b.removeClass("line-ht-twoRow line-ht-threeRow"),p.focus(),t.preventDefault()}),e("#questionBox li>a").on("click",function(t){var n=e(this).text();c(n),f(n),t.preventDefault()});var O="keypress";w&&(O="keyup"),p.on(O,function(t){var n=e.trim(e(this).val());13==(t.keyCode||t.which)?w?""!=n&&s(this):(""!=n&&(c(n),f(n)),p.val("").removeAttr("style"),b.removeClass("line-ht-twoRow line-ht-threeRow"),g.scrollTop(g[0].scrollHeight),t.preventDefault()):""!=n?s(this):p.val("").removeAttr("style")});var M={"Content-Type":"application/json;charset=UTF-8",T328JSS382RN:"067f592e-0f3e-48d5-9004-9c114255a15f"}},e.setActiveMenuLink=function(){var t=window.location,n=t.pathname.substring(t.pathname.lastIndexOf("/")+1,t.pathname.lastIndexOf("."));e('.menu-link[data-link="'+n+'"]').addClass("active")},e.radioCheckFirefoxInit=function(){if(navigator.userAgent.indexOf("Firefox")!=-1){var t=e("input[type=radio]");e(t).after("<label></label>")}},e.getScrollbarWidth=function(){var t,n,o;return"visible"==e("body").css("overflow-y")?void 0===o&&(t=e('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),n=t.children(),o=n.innerWidth()-n.height(99).innerWidth(),t.remove()):o=0,o},e.isDevice=function(){var t=!1;$window=e(window);var o=e.getScrollbarWidth();return $window.outerWidth()+o<n&&(t=!0),t};var i=e.isDevice();e.fn.scrollTo=function(t,n,o){"function"==typeof n&&2==arguments.length&&(o=n,n=t);var i=e.extend({scrollTarget:t,offsetTop:50,duration:500,easing:"swing"},n);return this.each(function(){var t=e(this),n="number"==typeof i.scrollTarget?i.scrollTarget:e(i.scrollTarget),a="number"==typeof n?n:n.offset().top+t.scrollTop()-parseInt(i.offsetTop);t.animate({scrollTop:a},parseInt(i.duration),i.easing,function(){"function"==typeof o&&o.call(this)})})},e.extend(e.expr[":"],{containIgnoreCase:function(e,t,n,o){return(e.textContent||e.innerText||"").toLowerCase().indexOf((n[3]||"").toLowerCase())>=0}}),e.megaMenuInit=function(t){function n(){l.removeClass("navbar-hidden").stop().animate({top:0},{queue:!1,duration:c}),r=!0}function o(){l.addClass("navbar-hidden").stop().animate({top:-l.outerHeight()},{queue:!1,duration:c}),e(".dropdown.open .dropdown-toggle",e(".navbar")).dropdown("toggle"),r=!1}if(e("#headerMenu").length>0){var i=e(window),a=null,s=e("#headerMenu").outerHeight(),r=!0,l=(i.height(),e(document),e(".navbar")),c=300;i.bind("scroll."+t,function(){var e=i.scrollTop(),t=e-a;if(a=e,0==e)setTimeout(function(){l.addClass("animate").removeClass("navbar-white")},500);else if(l.removeClass("animate"),t<0){if(r)return;n(),l.addClass("navbar-white")}else if(t>0){if(!r)return;if(e>=s){if(!r)return;o()}}})}},e.calculateHeight=function(t){if(!i){var n=-1;setTimeout(function(){e(t).each(function(){n=n>e(this).height()?n:e(this).height()}),e(t).each(function(){e(this).css("min-height",n)})},150)}},e.inputOpacityInit=function(t){var n=e(t);n.on("focus",function(){e(this).parents(".email").addClass("clear-opacity")}),n.on("blur",function(){e(this).parents(".email").removeClass("clear-opacity")})},e.clientSearchInit=function(n,o){e(n).keyup(function(){var n=e("#faqBox");if(0==e.trim(e(this).val()).length){var i=n.find(".clearfix");i.length>0&&i.show()}t(o,e(this).val())})},e.showSearchText=function(e,n){t(e,n)},e.mobileToggleInit=function(t,n){var o=e(t);i?o.on("click",function(){e(this).find(n).stop().slideToggle(400),e(this).find(".chevron").toggleClass("up")}):o.unbind("click")},e.loadImageInit=function(){function t(e){e?n(o,"mobile-src"):n(o,"desktop-src")}function n(t,n){t.each(function(t){var o=e(this);o.attr("src",o.attr(n)).addClass("img-opacity")})}var o=e(".img-src");o.length>0&&(t(i),$window.bind("resize.loadImageSrc",function(){i=e.isDevice(),t(i)}))},e.headerImgAutoScaleInit=function(t,n){$window=e(window);var i=$window.height();i>o&&(e(n).css("height",$window.outerHeight()),$window.bind("resize."+t,function(){e(window).outerHeight()>o&&e(n).css("height",$window.outerHeight())}))},e.countBoxVisible=function(t){var n=e(t+" .inside-content-box:visible").length;0!=n&&e(t+" .count").html("("+n+")")},e.createDealsMobileInit=function(t){var n="",o="";e(".deal-box[mobile-position]").each(function(t,n){var i=e(".deal-box[mobile-position="+(t+1)+"]").prop("outerHTML");o+=i}),n+='<div class="col-md-4 col-sm-4">'+o+"</div>";var i=e("#mobileDeals");i.html(n).promise().done(function(){i.find("[mob-href]").each(function(t,n){var o=e(this),i=o.attr("mob-href");o.attr("href",i)}),i.find("[mob-id]").each(function(t,n){var o=e(this),i=o.attr("mob-id");o.attr("id",i)})}),"function"==typeof t&&t.call(this)},e.isRealDevice=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Opera Mini/i.test(navigator.userAgent)},e.isAndroidDevice=function(){var e=navigator.userAgent.toLowerCase(),t=e.indexOf("android")>-1;return t},e.isAndroidKarbonn=function(){function t(e){e.attr("readonly","readonly"),e.attr("disabled","true"),setTimeout(function(){e.blur(),e.removeAttr("readonly"),e.removeAttr("disabled")},100)}var n=navigator.userAgent.toLowerCase(),o=n.indexOf("karbonn")>-1;if(o){var i=e(".chat-box"),a=e(".chat-box-bottom");e("#chatContent").on("focusin",function(){a.css({position:"relative"}),i.css({overflow:"scroll","padding-bottom":"260px"}),i.addClass("androidFix").scrollTop(i.height()+100).removeClass("androidFix")}),e("#chatBody").on("touchstart",function(){a.css({position:"absolute"}).blur(),i.css({"padding-bottom":"0"})}),e("#chatBody").on("touchend",function(){t(a)})}},e.isIOSDevice=function(){return/webOS|iPhone|iPad|iPod/i.test(navigator.userAgent)},e.surveyQuestionInit=function(){function t(t){t.closest("ul").closest("li").find(".sub-question").each(function(t,n){var o=e(n).closest("li").find('input[type="checkbox"]');o.length>0&&o.is(":not(:checked)")&&e(n).hide()})}function n(){var t=0;return e(".questionnaire-box").find('>li[data-required="true"]').each(function(n,o){var i=e(this),a=e(o).find('input[type="checkbox"]:checked').length,s=e(o).find('input[type="radio"]:checked').length;a>0||s>0?(t++,i.removeClass("tofill")):i.addClass("tofill")}),t}function o(t){e("html, body").animate({scrollTop:t})}function i(){var t=0,n=!1,o=e('input[data-validate="true"]:checked');if(o.length>0){var i=o.closest("li").find(".sub-question"),a=i.find('input[type="checkbox"]:checked').length,s=i.find('input[type="radio"]:checked').length;a>0||s>0?(t++,o.removeClass("toFillYesNo")):o.addClass("toFillYesNo"),n=t>0}else n=!0;return n}e('input[type="radio"], input[type="checkbox"]').on("change",function(){var n=e(this);if(n.is(":checked")){var o=n.closest("li").find(".sub-question:first");n.is(":checkbox")?t(n):n.closest("ul").closest("li").find(".sub-question").hide(),o.length>0&&(o.is(":visible")||(o.show(),o.find('input[type="text"]:first').focus()))}else n.is(":checkbox")&&n.closest("li").find(".sub-question").hide()}),e('#answerTopThree input[type="checkbox"]').on("change",function(){e('#answerTopThree input[type="checkbox"]:checked').length>=3?e('#answerTopThree input[type="checkbox"]:not(:checked)').attr("disabled","disabled"):e('#answerTopThree input[type="checkbox"]:not(:checked)').removeAttr("disabled")}),e("#notAwareOptionCb").on("change",function(){var t=e('#notAwareOptionId input[type="checkbox"]:not("#notAwareOptionCb")');e(this).is(":checked")?t.removeAttr("checked").attr("disabled","disabled"):t.removeAttr("disabled")}),e("#btnSubmit").on("click",function(t){var a=e(".questionnaire-box").find('>li[data-required="true"]').length,s=n(),r=i();if(a==s)if(r)e("#questionForm").submit();else{var l=e(".toFillYesNo:first").offset().top-(e("#headerMenu").height()+50);o(l)}else{var l=e(".questionnaire-box").find(">li.tofill:first").offset().top-(e("#headerMenu").height()+50);o(l)}t.preventDefault()})},e(".screenVA, .screenPFM, .screenSoftToken, .dePhone, .safetyPhone").css("opacity","0"),e("body").hasClass("features")&&(e(".screenSoftToken").on("inview",function(t,n){n&&e(".debitCard").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend")&&e(".screenSoftToken").delay(500).queue(function(){e(this).addClass("animated fadeInLeft")})}),e(".screenVA").on("inview",function(t,n){n&&e(this).addClass("animated fadeInRight")}),e(".screenPFM").on("inview",function(t,n){n&&e(this).addClass("animated fadeInLeft")})),e("body").hasClass("home")&&(e(".dePhone").on("inview",function(t,n){n&&e(this).addClass("animated fadeIn")}),e(".safetyPhone").on("inview",function(t,n){n&&e(this).addClass("animated fadeInLeft")})),e.QueryString("app")&&e("body").addClass("webview")}(jQuery);